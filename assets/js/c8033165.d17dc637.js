"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1729],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var r=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,l=function(e,t){if(null==e)return{};var n,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=r.createContext({}),c=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},b=r.forwardRef((function(e,t){var n=e.components,l=e.mdxType,a=e.originalType,s=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),b=c(n),u=l,g=b["".concat(s,".").concat(u)]||b[u]||p[u]||a;return n?r.createElement(g,o(o({ref:t},m),{},{components:n})):r.createElement(g,o({ref:t},m))}));function u(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var a=n.length,o=new Array(a);o[0]=b;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}b.displayName="MDXCreateElement"},8523:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=n(7462),l=(n(7294),n(3905));const a={slug:"/wasm-wat",sidebar_label:"WAT"},o="\u3010WebAssembly\u3011WAT",i={unversionedId:"technology/web/wasm/wasm-wat",id:"technology/web/wasm/wasm-wat",title:"\u3010WebAssembly\u3011WAT",description:"WAT \u306f\u3001WebAssembly \u306b\u304a\u3051\u308b\u64ec\u4f3c\u30a2\u30bb\u30f3\u30d6\u30ea\u8a00\u8a9e\u3067\u3059\u3002",source:"@site/notes/technology/web/wasm/wasm-wat.md",sourceDirName:"technology/web/wasm",slug:"/wasm-wat",permalink:"/notes/wasm-wat",draft:!1,editUrl:"https://github.com/NaokiKosuge/NaokiKosuge.github.io/edit/main/notes/technology/web/wasm/wasm-wat.md",tags:[],version:"current",frontMatter:{slug:"/wasm-wat",sidebar_label:"WAT"},sidebar:"tutorialSidebar",previous:{title:"AssemblyScript",permalink:"/notes/assemblyscript"},next:{title:"Web API \u4e00\u89a7",permalink:"/notes/web-ali"}},s={},c=[{value:"hello world",id:"hello-world",level:2},{value:"2\u3064\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30b9\u30bf\u30a4\u30eb",id:"2\u3064\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30b9\u30bf\u30a4\u30eb",level:2}],m={toc:c};function p(e){let{components:t,...n}=e;return(0,l.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"webassemblywat"},"\u3010WebAssembly\u3011WAT"),(0,l.kt)("abbr",{title:"WebAssembly Text"},"WAT")," \u306f\u3001WebAssembly \u306b\u304a\u3051\u308b\u64ec\u4f3c\u30a2\u30bb\u30f3\u30d6\u30ea\u8a00\u8a9e\u3067\u3059\u3002",(0,l.kt)("p",null,"Web \u30d6\u30e9\u30a6\u30b6\u306e\u3067\u304d\u308b\u3060\u3051\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u306b\u8fd1\u3044\u3068\u3053\u308d\u3067\u4f5c\u696d\u3092\u884c\u3046\u305f\u3081\u306e\u6700\u3082\u3088\u3044\u65b9\u6cd5\u306f\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u3092 WAT \u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u3059\u3002WAT \u306e\u77e5\u8b58\u304c\u3042\u308c\u3070\u3001\u3053\u308c\u4ee5\u4e0a\u306a\u3044\u307b\u3069\u30cf\u30a4\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306a Web \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u306e\u306b\u5f79\u7acb\u3064\u306f\u305a\u3067\u3059\u3002"),(0,l.kt)("h2",{id:"hello-world"},"hello world"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-wasm",metastring:'title="helloworld.wat"',title:'"helloworld.wat"'},'(module\n  ;; [1] \u95a2\u6570\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\n  (import "env" "print string" (func $print string (param i32)))\n\n  ;; [2] \u95a2\u6570\u3068\u30e1\u30e2\u30ea\u30d0\u30c3\u30d5\u30a1\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\n  (import "env" "buffer" (memory 1))\n\n  ;; [3] \u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\u306e\u8ffd\u52a0\n  (global $start string (import "env" "start string") i32)\n  (global $string len i32 (i32.const 12))\n\n  ;; [4] \u30c7\u30fc\u30bf\u6587\u5b57\u5217\u306e\u8ffd\u52a0\n  (data (global.get $start string) "hello world!")\n\n  ;; [5] helloworld \u95a2\u6570\u306e\u8ffd\u52a0\n  (func (export "helloworld")\n    (call $print string (global.get $string len))\n  )\n)\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="helloworld.js"',title:'"helloworld.js"'},"const fs = require('fs');\nconst bytes = fs.readFileSync(__dirname + '/helloworld');\n\n// [1] JavaScript \u5909\u6570\u306e\u5ba3\u8a00\nlet hello_world = null;\nlet start_string_index = 100;\nlet memory = new WebAssembly.Memory({ initial: 1 });\n\n// [2] importObject \u5909\u6570\u306e\u5ba3\u8a00\nlet importObject = {\n  env: {\n    buffer: memory,\n    start_string: start_string_index,\n    print_string: function(str_len) {\n      const bytes = new Uint8Array(memory.buffer,\n                                   start_string_index,\n                                   str_len);\n      const log_string = new TextDecoder('utf8').decode(bytes);\n      console.log(log_string);\n    },\n  },\n};\n\n// [3] \u975e\u540c\u671f IIFE \u3067 WebAssembly \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5316\n(async () => {\n  let obj = await WebAssembly.instantiate(new Uint8Array(bytes),\n                                          importObjects);\n  ({helloworld: hello_world} = obj.instance>exports);\n  hello_world();\n})();\n")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"2\u3064\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30b9\u30bf\u30a4\u30eb"},"2\u3064\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30b9\u30bf\u30a4\u30eb"),(0,l.kt)("p",null,"WAT \u306b\u306f\u4e3b\u306b2\u7a2e\u985e\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30b9\u30bf\u30a4\u30eb\u304c\u3042\u308a\u3001\u3069\u3061\u3089\u304b\u7247\u65b9\u307e\u305f\u306f\u4e21\u65b9\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"\u7dda\u5f62\u547d\u4ee4\u30ea\u30b9\u30c8"),"\u30b9\u30bf\u30a4\u30eb \u2013 \u6697\u9ed9\u7684\u306a\u30b9\u30bf\u30c3\u30af\u3092\u4f7f\u3046\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u69cb\u9020"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-wasm",metastring:'title="\u7dda\u5f62\u547d\u4ee4\u30ea\u30b9\u30c8\u30b9\u30bf\u30a4\u30eb\u306e\u4f8b\uff1a2\u3064\u306e\u5024\u3092\u52a0\u7b97\u3059\u308b" {6-10}',title:'"\u7dda\u5f62\u547d\u4ee4\u30ea\u30b9\u30c8\u30b9\u30bf\u30a4\u30eb\u306e\u4f8b\uff1a2\u3064\u306e\u5024\u3092\u52a0\u7b97\u3059\u308b"',"{6-10}":!0},'(module\n  (global $a_val (mut i32) (i32.const 1))\n  (global $b_val (mut i32) (i32.const 2))\n  (global $c_val (mut i32) (i32.const 0))\n  (func $main (export "main")\n    global.get $a_val\n    global.get $b_val\n    \n    i32.add\n    global.set $c_val\n  )\n)\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},"S\u5f0f"),"\u30b9\u30bf\u30a4\u30eb \u2013 \u6728\u5f62\u5f0f\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u69cb\u9020\u3067\u3001\u7dda\u5f62\u547d\u4ee4\u30ea\u30b9\u30c8\u30b9\u30bf\u30a4\u30eb\u306e\u7cd6\u8863\u69cb\u6587"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-wasm",metastring:'title="S\u5f0f\u30b9\u30bf\u30a4\u30eb\u306e\u4f8b\uff1a2\u3064\u306e\u5024\u3092\u52a0\u7b97\u3059\u308b" {6-8}',title:'"S\u5f0f\u30b9\u30bf\u30a4\u30eb\u306e\u4f8b\uff1a2\u3064\u306e\u5024\u3092\u52a0\u7b97\u3059\u308b"',"{6-8}":!0},'(module\n  (global $a_val (mut i32) (i32.const 1))\n  (global $b_val (mut i32) (i32.const 2))\n  (global $c_val (mut i32) (i32.const 0))\n  (func $main (export "main")\n    (global.set $c_val\n      (i32.add (global.get $a_val) (global.get $b_val))\n    )\n  )\n)\n')))))}p.isMDXComponent=!0}}]);